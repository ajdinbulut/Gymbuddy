@using GymBuddy.Core.Entities
@using GymBuddy.Infrastructure.Utilities
@using Gymbuddy.ViewModels
@model PostViewModel
@inject UserManager _userManager

        <style>
           
    #form1{
        border:solid 3px grey;
        border-radius:1em;
        background-color:grey;
            }
    #post1{
        width:50%;
        height:50%;
        border:solid 3px grey;
        margin-bottom:3px;
        border-radius:0.5em;
        background-color:grey;
    }
   
    #post2{
        background-color:#AFAFAF;
    }
    /*img{
        width:50%;
        height:50%;
        margin-left:5px;
    }*/
    p{
        margin-left:5px;
    }
   /* #dd1{
        
        position:relative;
        left:80%;
        
    }*/
    #container{
        height:100%;
        width:75%;
        margin:auto;
        padding:0.5em;
    }
    *{
        box-sizing:border-box;
        margin:0;
        padding:0;
    }
    #postbtn{
        color:black;
        text-decoration:none;
        border:none;
        background-color:rgb(255,255,255);
        padding:0.2em 0.5em;
        margin-top:3px;
    }
    #postbtn:hover{
        background-color:rgb(255,255,255,0.8);
    }
  
    #postimg{
        height:100%;
        width:100%;
    }
    #comments{
        display:flex;
        flex-direction:column;
        justify-content:center;
        margin:5px;
        border-radius:0.5em;
    }
    #likebtn{
        border:none;
        background-color:white;
        margin-left:5px;
        padding:5px 15px;
        transition:all 0.3s ease 0s;
    }
    #likebtn:hover{
        color:#0088a9;
        background-color: rgb(255,255,255,0.9);

    }
  
        </style>
@if(TempData["success"] != null){
       <h2>@TempData["success"]</h2>
}

 <div class="bg-dark d-block mt-0 mb-0 d-flex flex-column align-items-center" id="container">

@if (_userManager.isSignedIn())
{

    <form asp-action="Post" asp-controller="Home" method="post" enctype="multipart/form-data">
        <div class=" p-3 mt-4" style="height:200px;width:700px" id="form1">
            <input type="hidden" name="id" />
            <div class="col-md-12 ">
                <textarea asp-for="Post.Description" placeholder="Enter a description of your post.." class="form-control"></textarea> 
            </div>
            <div class="col-md-6 mt-2">
                <label hidden asp-for="Post.ImageUrl"></label>
                <input type="file" name="file" placeholder="Select an image.." class="form-control"/>
            </div>
           <button type="submit"  id="postbtn">Submit</button>

        </div>
    </form>

    @foreach (var post in Model.Posts)
    { 
        <div id="post1" class="mt-3 mb-3 ms-lg-2 w-50 h-50 shadow-lg" style="height:600px;width:500px">
            <div id="post2">
                <h3 class="ms-lg-2 d-inline">@post.User.Name</h3>
                @{
                    var user = _userManager.Get();
                   
                                                                                                                                                                                                                                                                                        <div class="btn-group dropstart float-end">
                                                                                                                                                                                                                                                                                                  <button type="button" class="btn btn-secondary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                                                                                                                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                  </button>
                                                                                                                                                                                                                                                                                           <ul class="dropdown-menu" aria-labelledby="#dropdownMenuButton">
                                                                                                                                                                                                                                                                                               @if (user.Id == post.UserId)
                    {
                                                                                                                                                                                                                                                                                               <li > 
                                                                                                                                                                                                                                                                                                    <a class="dropdown-item" asp-action="DeletePost" asp-controller="Home" asp-route-id="@post.Id" >Delete </a>
                                                                                                                                                                                                                                                                                               </li>
                    }
                                                                                                                                                                                                                                                                                           </ul>
                                                                                                                                                                                                                                                                                        </div>
                    
                }
                <hr class="text-black">
                <p class="ms-lg-2">@post.Description</p>
                
            </div>
            <div >
              <img src="@post.ImageUrl" class="rounded mx-auto d-block" id="postimg">
            </div>
            <hr class="text-black">
            <div>
                <button id="likebtn"><i class="fa-regular fa-thumbs-up"></i> Like</button>
            </div>
            <hr class="text-black">

            
            @foreach(var item in post.Comments){
                @if(@*item.PostId == post.Id && *@item.Id != null){
             <div class="bg-white" id="comments">
                        <h6 style="margin:5px" id="h6">@item.User.Name</h6>
                         <hr class="text-black">
                        <span style="margin:5px" id="span">@item.Description</span>
             </div>
           }
            }
                
                <form asp-action="Comment" asp-controller="Home" asp-route-id="@post.Id" method="post">
            <div>
                        
                <textarea asp-for="Comment.Description" placeholder="Comment something.." class="form-control d-inline"></textarea>
                <button type="submit"class="btn btn-dark d-inline">Submit</button>
            </div>
            </form>
        </div>
    }

}
</div>
@section Scripts{
    <script>
let likebtn = document.getElementById('likebtn');
likebtn.onclick = function() {
    
}

//$.ajax({
//    type:"POST",
//    url:"@Url.Action("LikePost")",
//    dataType:"json",
//    success: function(result) {
//        console.log(result);
//    },
//    error: function(req,status,error){
//        console.log(status);
//    }
//})
    </script>
}